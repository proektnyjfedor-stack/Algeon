/// –î–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á –¥–ª—è MathPilot
/// 
/// –î–≤–∞ —Ç–∏–ø–∞ –∑–∞–¥–∞–Ω–∏–π:
/// - multipleChoice: –≤—ã–±–æ—Ä –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
/// - textInput: —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ

import '../models/task.dart';

/// –í—Å–µ –∑–∞–¥–∞—á–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
final List<Map<String, dynamic>> tasksData = [
  // === –¢–µ–º–∞: –£–º–Ω–æ–∂–µ–Ω–∏–µ (2 –∫–ª–∞—Å—Å) ===
  {
    'id': 'mult_2_01',
    'grade': 2,
    'topic': '–£–º–Ω–æ–∂–µ–Ω–∏–µ',
    'question': '3 √ó 6 = ?',
    'type': 'multipleChoice',
    'options': ['24', '18', '16', '17'],
    'answer': '18',
    'explanationSteps': [
      '–£–º–Ω–æ–∂–µ–Ω–∏–µ ‚Äî —ç—Ç–æ —Å–ª–æ–∂–µ–Ω–∏–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —á–∏—Å–µ–ª',
      '3 √ó 6 –æ–∑–Ω–∞—á–∞–µ—Ç: 3 + 3 + 3 + 3 + 3 + 3',
      '–ò–ª–∏ –º–æ–∂–Ω–æ: 6 + 6 + 6',
      '6 + 6 = 12',
      '12 + 6 = 18',
      '–û—Ç–≤–µ—Ç: 18',
    ],
  },
  {
    'id': 'mult_2_02',
    'grade': 2,
    'topic': '–£–º–Ω–æ–∂–µ–Ω–∏–µ',
    'question': '4 √ó 5 = ?',
    'type': 'multipleChoice',
    'options': ['20', '25', '15', '18'],
    'answer': '20',
    'explanationSteps': [
      '4 √ó 5 –æ–∑–Ω–∞—á–∞–µ—Ç: 4 –≤–∑—è—Ç—å 5 —Ä–∞–∑',
      '4 + 4 + 4 + 4 + 4 = ?',
      '4 + 4 = 8',
      '8 + 4 = 12',
      '12 + 4 = 16',
      '16 + 4 = 20',
      '–û—Ç–≤–µ—Ç: 20',
    ],
  },
  {
    'id': 'mult_2_03',
    'grade': 2,
    'topic': '–£–º–Ω–æ–∂–µ–Ω–∏–µ',
    'question': '7 √ó 3 = ?',
    'type': 'multipleChoice',
    'options': ['21', '24', '18', '27'],
    'answer': '21',
    'explanationSteps': [
      '7 √ó 3 –æ–∑–Ω–∞—á–∞–µ—Ç: 7 + 7 + 7',
      '7 + 7 = 14',
      '14 + 7 = 21',
      '–û—Ç–≤–µ—Ç: 21',
    ],
  },
  
  // === –¢–µ–º–∞: –¢–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ (2 –∫–ª–∞—Å—Å) ===
  {
    'id': 'text_2_01',
    'grade': 2,
    'topic': '–¢–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–¥–∞—á–∏',
    'question': '–î–ª—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –æ–±–µ–¥–∞ –ø–æ–≤–∞—Ä—É –ø–æ–Ω–∞–¥–æ–±–∏–ª–æ—Å—å 24 –∫–≥ –∫–∞—Ä—Ç–æ—à–∫–∏, —Å–≤–µ–∫–ª—ã –≤ 3 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ, –∞ –ª—É–∫–∞ –≤ 2 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ —á–µ–º —Å–≤–µ–∫–ª—ã. –°–∫–æ–ª—å–∫–æ –∫–∏–ª–æ–≥—Ä–∞–º–º –ª—É–∫–∞ –ø–æ—Ç—Ä–∞—Ç–∏–ª –ø–æ–≤–∞—Ä?',
    'type': 'textInput',
    'answer': '4',
    'unit': '–∫–≥',
    'hint': '–†–µ—à–∏—Ç–µ –∑–∞–¥–∞—á—É...',
    'explanationSteps': [
      '–®–∞–≥ 1: –ù–∞–π–¥—ë–º —Å–∫–æ–ª—å–∫–æ —Å–≤–µ–∫–ª—ã',
      '–°–≤–µ–∫–ª—ã –≤ 3 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ —á–µ–º –∫–∞—Ä—Ç–æ—à–∫–∏',
      '24 √∑ 3 = 8 –∫–≥ —Å–≤–µ–∫–ª—ã',
      '–®–∞–≥ 2: –ù–∞–π–¥—ë–º —Å–∫–æ–ª—å–∫–æ –ª—É–∫–∞',
      '–õ—É–∫–∞ –≤ 2 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ —á–µ–º —Å–≤–µ–∫–ª—ã',
      '8 √∑ 2 = 4 –∫–≥ –ª—É–∫–∞',
      '–û—Ç–≤–µ—Ç: 4 –∫–≥',
    ],
  },
  {
    'id': 'text_2_02',
    'grade': 2,
    'topic': '–¢–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–¥–∞—á–∏',
    'question': '–í –º–∞–≥–∞–∑–∏–Ω –ø—Ä–∏–≤–µ–∑–ª–∏ 36 –∫–≥ —è–±–ª–æ–∫ –∏ 12 –∫–≥ –≥—Ä—É—à. –í–æ —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —è–±–ª–æ–∫ –±–æ–ª—å—à–µ —á–µ–º –≥—Ä—É—à?',
    'type': 'textInput',
    'answer': '3',
    'hint': '–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ...',
    'explanationSteps': [
      '–ß—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –≤–æ —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –æ–¥–Ω–æ —á–∏—Å–ª–æ –±–æ–ª—å—à–µ –¥—Ä—É–≥–æ–≥–æ, –Ω—É–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å',
      '36 √∑ 12 = ?',
      '36 √∑ 12 = 3',
      '–û—Ç–≤–µ—Ç: –≤ 3 —Ä–∞–∑–∞',
    ],
  },
  {
    'id': 'text_2_03',
    'grade': 2,
    'topic': '–¢–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–¥–∞—á–∏',
    'question': '–£ –ü–µ—Ç–∏ 15 –º–∞—Ä–æ–∫, –∞ —É –í–∞—Å–∏ –≤ 3 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ. –°–∫–æ–ª—å–∫–æ –º–∞—Ä–æ–∫ —É –í–∞—Å–∏?',
    'type': 'multipleChoice',
    'options': ['45', '18', '5', '30'],
    'answer': '45',
    'explanationSteps': [
      '¬´–í 3 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ¬ª –æ–∑–Ω–∞—á–∞–µ—Ç —É–º–Ω–æ–∂–∏—Ç—å –Ω–∞ 3',
      '15 √ó 3 = ?',
      '15 √ó 3 = 45',
      '–û—Ç–≤–µ—Ç: 45 –º–∞—Ä–æ–∫',
    ],
  },
  
  // === –¢–µ–º–∞: –ú–∞—Å—Å–∞ (2 –∫–ª–∞—Å—Å) ===
  {
    'id': 'mass_2_01',
    'grade': 2,
    'topic': '–ú–∞—Å—Å–∞: –∫–≥ –∏ –≥',
    'question': '–£ –ú–∞—à–∏ –±—ã–ª–æ 2 –∫–≥ —è–±–ª–æ–∫. –û–Ω–∞ –æ—Ç–¥–∞–ª–∞ 500 –≥. –°–∫–æ–ª—å–∫–æ –≥—Ä–∞–º–º–æ–≤ –æ—Å—Ç–∞–ª–æ—Å—å?',
    'type': 'textInput',
    'answer': '1500',
    'unit': '–≥',
    'hint': '–û—Ç–≤–µ—Ç –≤ –≥—Ä–∞–º–º–∞—Ö...',
    'explanationSteps': [
      '–®–∞–≥ 1: –ü–µ—Ä–µ–≤–µ–¥—ë–º –∫–≥ –≤ –≥—Ä–∞–º–º—ã',
      '2 –∫–≥ = 2000 –≥',
      '–®–∞–≥ 2: –í—ã—á—Ç–µ–º —Ç–æ, —á—Ç–æ –æ—Ç–¥–∞–ª–∞',
      '2000 - 500 = 1500 –≥',
      '–û—Ç–≤–µ—Ç: 1500 –≥',
    ],
  },
  {
    'id': 'mass_2_02',
    'grade': 2,
    'topic': '–ú–∞—Å—Å–∞: –∫–≥ –∏ –≥',
    'question': '–°–∫–æ–ª—å–∫–æ –≥—Ä–∞–º–º–æ–≤ –≤ 3 –∫–≥?',
    'type': 'multipleChoice',
    'options': ['300', '3000', '30', '30000'],
    'answer': '3000',
    'explanationSteps': [
      '1 –∫–≥ = 1000 –≥',
      '3 –∫–≥ = 3 √ó 1000 –≥',
      '3 √ó 1000 = 3000',
      '–û—Ç–≤–µ—Ç: 3000 –≥',
    ],
  },
  
  // === –¢–µ–º–∞: –î–ª–∏–Ω–∞ (2 –∫–ª–∞—Å—Å) ===
  {
    'id': 'length_2_01',
    'grade': 2,
    'topic': '–î–ª–∏–Ω–∞: –º, –¥–º, —Å–º',
    'question': '–õ–µ–Ω—Ç–∞ –¥–ª–∏–Ω–æ–π 1 –º. –û—Ç—Ä–µ–∑–∞–ª–∏ 30 —Å–º. –°–∫–æ–ª—å–∫–æ —Å–º –æ—Å—Ç–∞–ª–æ—Å—å?',
    'type': 'textInput',
    'answer': '70',
    'unit': '—Å–º',
    'hint': '–û—Ç–≤–µ—Ç –≤ —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä–∞—Ö...',
    'explanationSteps': [
      '–®–∞–≥ 1: –ü–µ—Ä–µ–≤–µ–¥—ë–º –º–µ—Ç—Ä—ã –≤ —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä—ã',
      '1 –º = 100 —Å–º',
      '–®–∞–≥ 2: –í—ã—á—Ç–µ–º',
      '100 - 30 = 70 —Å–º',
      '–û—Ç–≤–µ—Ç: 70 —Å–º',
    ],
  },
  {
    'id': 'length_2_02',
    'grade': 2,
    'topic': '–î–ª–∏–Ω–∞: –º, –¥–º, —Å–º',
    'question': '–°–∫–æ–ª—å–∫–æ —Å–º –≤ 2 –º 50 —Å–º?',
    'type': 'multipleChoice',
    'options': ['250', '205', '2500', '25'],
    'answer': '250',
    'explanationSteps': [
      '2 –º = 200 —Å–º',
      '200 + 50 = 250 —Å–º',
      '–û—Ç–≤–µ—Ç: 250 —Å–º',
    ],
  },
  
  // === 3 –∫–ª–∞—Å—Å ===
  {
    'id': 'mult_3_01',
    'grade': 3,
    'topic': '–£–º–Ω–æ–∂–µ–Ω–∏–µ –∏ –¥–µ–ª–µ–Ω–∏–µ',
    'question': '56 √∑ 8 = ?',
    'type': 'multipleChoice',
    'options': ['7', '8', '6', '9'],
    'answer': '7',
    'explanationSteps': [
      '–ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ —á–∏—Å–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏ —É–º–Ω–æ–∂–µ–Ω–∏–∏ –Ω–∞ 8 –¥–∞—Å—Ç 56',
      '7 √ó 8 = 56',
      '–ó–Ω–∞—á–∏—Ç 56 √∑ 8 = 7',
      '–û—Ç–≤–µ—Ç: 7',
    ],
  },
  {
    'id': 'mult_3_02',
    'grade': 3,
    'topic': '–£–º–Ω–æ–∂–µ–Ω–∏–µ –∏ –¥–µ–ª–µ–Ω–∏–µ',
    'question': '9 √ó 8 = ?',
    'type': 'multipleChoice',
    'options': ['72', '63', '81', '64'],
    'answer': '72',
    'explanationSteps': [
      '9 √ó 8 ‚Äî –∏–∑ —Ç–∞–±–ª–∏—Ü—ã —É–º–Ω–æ–∂–µ–Ω–∏—è',
      '9 √ó 8 = 72',
      '–û—Ç–≤–µ—Ç: 72',
    ],
  },
];

/// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏ –∫–∞–∫ –æ–±—ä–µ–∫—Ç—ã Task
List<Task> getAllTasks() {
  return tasksData.map((json) => Task.fromJson(json)).toList();
}

/// –ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞—á–∏ –ø–æ –∫–ª–∞—Å—Å—É
List<Task> getTasksByGrade(int grade) {
  return getAllTasks().where((task) => task.grade == grade).toList();
}

/// –ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞—á–∏ –ø–æ —Ç–µ–º–µ
List<Task> getTasksByTopic(String topic) {
  return getAllTasks().where((task) => task.topic == topic).toList();
}

/// –ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞—á–∏ –ø–æ –∫–ª–∞—Å—Å—É –ò —Ç–µ–º–µ
List<Task> getTasksByGradeAndTopic(int grade, String topic) {
  return getAllTasks()
      .where((task) => task.grade == grade && task.topic == topic)
      .toList();
}

/// –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–µ–º –¥–ª—è –∫–ª–∞—Å—Å–∞
List<String> getTopicsByGrade(int grade) {
  final tasks = getTasksByGrade(grade);
  final topics = tasks.map((t) => t.topic).toSet().toList();
  return topics;
}

/// –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–º–µ
class TopicInfo {
  final String name;
  final int taskCount;
  final String icon;
  
  const TopicInfo({
    required this.name,
    required this.taskCount,
    required this.icon,
  });
}

/// –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–º–∞—Ö –¥–ª—è –∫–ª–∞—Å—Å–∞
List<TopicInfo> getTopicsInfoByGrade(int grade) {
  final topics = getTopicsByGrade(grade);
  return topics.map((topic) {
    final count = getTasksByGradeAndTopic(grade, topic).length;
    return TopicInfo(
      name: topic,
      taskCount: count,
      icon: _getTopicIcon(topic),
    );
  }).toList();
}

/// –ò–∫–æ–Ω–∫–∞ –¥–ª—è —Ç–µ–º—ã
String _getTopicIcon(String topic) {
  if (topic.contains('–£–º–Ω–æ–∂–µ–Ω–∏–µ')) return '‚úñÔ∏è';
  if (topic.contains('–î–µ–ª–µ–Ω–∏–µ')) return '‚ûó';
  if (topic.contains('–¢–µ–∫—Å—Ç–æ–≤—ã–µ')) return 'üìù';
  if (topic.contains('–ú–∞—Å—Å–∞')) return '‚öñÔ∏è';
  if (topic.contains('–î–ª–∏–Ω–∞')) return 'üìè';
  if (topic.contains('–í—Ä–µ–º—è')) return '‚è∞';
  return 'üìö';
}
